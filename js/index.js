function uuid(){var e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.substr(t.lastIndexOf("/")+1)}function milliseconds2date(e){var t=new Date(e);return t.getDate()+"/"+(t.getMonth()+1)+"/"+t.getFullYear()}function number_format(e){if(""===(e=e.toString()).trim())return"";for(var t=e.split(""),n=t.length,r="",d=1,m=n-1;m>=0;m--){var u=d%3==0&&0!==m?".":"";r=r+t[m]+u,d++}t=r.split(""),r="";for(m=(n=t.length)-1;m>=0;m--)r+=t[m];return r}function tinh_phat(e,t,n,r){var d,m,u,s,a,o=[];if(d=e.split("/")[0],m=e.split("/")[1],u=e.split("/")[2],(s=new Date(u,Number(m)-1,d)).getMonth()+1!=Number(m)||s.getDate()!=d||s.getFullYear()!=u)return["Bạn xác định sai ngày bắt đầu tính phạt. Ví dụ cách nhập: tính phạt chậm nộp 15.000.000 từ ngày 01/01/2016 đến 30/6/2016"];if(d=t.split("/")[0],m=t.split("/")[1],u=t.split("/")[2],(a=new Date(u,Number(m)-1,d)).getMonth()+1!=Number(m)||a.getDate()!=d||a.getFullYear()!=u)return["Bạn xác định sai ngày kết thúc tính phạt. Ví dụ cách nhập: tính phạt chậm nộp 15.000.000 từ ngày 01/01/2016 đến 30/6/2016"];var i=864e5,l=Date.parse(s),h=Date.parse(a);if(Math.round(h/i)-Math.round(l/i)+1<1)return["Số ngày tính phạt của bạn có vấn đề: ngày kết thúc tính phạt phải hơn ngày bắt đầu tính. Ví dụ cách nhập: tính phạt chậm nộp 15.000.000 từ ngày 01/01/2016 đến 30/6/2016"];var b,c=new Date(2013,5,30),g=new Date(2014,11,31),p=new Date(2016,5,30),f=Math.round(Date.parse(c)/i),_=Math.round(Date.parse(g)/i),x=Math.round(Date.parse(p)/i),N=Math.round(l/i),y=Math.round(h/i);return dg1="Từ hạn nộp đến 30/6/2013: Tính theo tỷ lệ 0,05% (Quy định của Luật số 78/2006/QH11)",dg2="Từ ngày 1/7/2013 đến 31/12/2014: tỷ lệ 0,05% kể từ ngày hết thời hạn nộp thuế đến ngày thứ 90; 0,07% kể từ ngày chậm nộp thứ 91 trở đi (Quy định của Luật số 21/2012/QH13)",dg3="Từ ngày 1/1/2015 - 30/6/2016: Tính theo tỷ lệ 0,05% (Quy định của Luật số 71/2014/QH13)",dg4="Từ ngày 1/7/2016: Tính theo tỷ lệ 0.03% (Quy định của Luật số 106/2016/QH13)",dg_phat_tien_phat="Theo Thông tư 166/2013/TT-BTC, tiền chậm nộp tiền phạt tính theo mức 0,05%/ngày",o=[],dg=[],0===r?(b=Number(n)*(y-N+1)*5e-4,dg.push(dg_phat_tien_phat),o.push(milliseconds2date(l)+"-"+milliseconds2date(h)+":"+number_format(n)+"x"+(y-N+1)+"x0,05% = "+number_format(Math.round(b)))):1===r&&(N>x?(b=Number(n)*(y-N+1)*3e-4,o.push(milliseconds2date(l)+"-"+milliseconds2date(h)+":"+number_format(n)+"x"+(y-N+1)+"x0,03% = "+number_format(Math.round(b))),dg.push(dg4)):_+1<=N&&N<=x?y>=x+1?(b=(x-N+1)*Number(n)*5e-4+(y-(x+1)+1)*Number(n)*3e-4,o.push(milliseconds2date(l)+"-"+milliseconds2date(x*i)+":"+number_format(n)+"x"+(x-N+1)+"x0,05% = "+number_format(Math.round((x-N+1)*Number(n)*5e-4))),dg.push(dg3),o.push(milliseconds2date((x+1)*i)+"-"+milliseconds2date(h)+":"+number_format(n)+"x"+(y-(x+1)+1)+"x0,03% = "+number_format(Math.round((y-(x+1)+1)*Number(n)*3e-4))),dg.push(dg4)):(b=(y-N+1)*Number(n)*5e-4,o.push(milliseconds2date(l)+"-"+milliseconds2date(h)+":"+number_format(n)+"x"+(y-N+1)+"x0,05% = "+number_format(Math.round(b))),dg.push(dg3)):f+1<=N&&N<=_?f+1<=y&&y<=_?y-N+1<=90?(b=(y-N+1)*Number(n)*5e-4,o.push(milliseconds2date(l)+"-"+milliseconds2date(h)+":"+number_format(n)+"x"+(y-N+1)+"x0,05% = "+number_format(Math.round(b))),dg.push(dg2)):(b=90*Number(n)*5e-4+(y-N-90+1)*Number(n)*7e-4,o.push(milliseconds2date(l)+"-"+milliseconds2date((N+89)*i)+":"+number_format(n)+"x90x0,05% = "+number_format(Math.round(90*Number(n)*5e-4))),dg.push(dg2),o.push(milliseconds2date((N+90)*i)+"-"+milliseconds2date(h)+":"+number_format(n)+"x"+(y-N-90+1)+"x0,07% = "+number_format(Math.round((y-N-90+1)*Number(n)*7e-4))),dg.push(dg2)):_+1<=y&&y<=x?_-N+1<=90?(b=(y-N+1)*Number(n)*5e-4,o.push(milliseconds2date(l)+"-"+milliseconds2date(h)+":"+number_format(n)+"x"+(y-N+1)+"x0,05% = "+number_format(Math.round(b))),dg.push(dg2)):(b=90*Number(n)*5e-4+(_-N-90+1)*Number(n)*7e-4+(y-(_+1)+1)*Number(n)*5e-4,o.push(milliseconds2date(l)+"-"+milliseconds2date((N+89)*i)+":"+number_format(n)+"x90x0,05% = "+number_format(Math.round(90*Number(n)*5e-4))),dg.push(dg2),o.push(milliseconds2date((N+90)*i)+"-"+milliseconds2date(_*i)+":"+number_format(n)+"x"+(_-N-90+1)+"x0,07% = "+number_format(Math.round((_-N-90+1)*Number(n)*7e-4))),dg.push(dg2),o.push(milliseconds2date((_+1)*i)+"-"+milliseconds2date(h)+":"+number_format(n)+"x"+(y-(_+1)+1)+"x0,05% = "+number_format(Math.round((y-(_+1)+1)*Number(n)*5e-4))),dg.push(dg3)):y>x&&(_-N+1<=90?(b=(x-N+1)*Number(n)*5e-4+(y-(x+1)+1)*Number(n)*3e-4,o.push(milliseconds2date(l)+"-"+milliseconds2date(x*i)+":"+number_format(n)+"x"+(x-N+1)+"x0,05% = "+number_format(Math.round((x-N+1)*Number(n)*5e-4))),dg.push(dg2+"; "+dg3),o.push(milliseconds2date((x+1)*i)+"-"+milliseconds2date(h)+":"+number_format(n)+"x"+(y-(x+1)+1)+"x0,03% = "+number_format(Math.round((y-(x+1)+1)*Number(n)*3e-4))),dg.push(dg4)):(b=90*Number(n)*5e-4+(_-N-90+1)*Number(n)*7e-4+(x-(_+1)+1)*Number(n)*5e-4+(y-(x+1)+1)*Number(n)*3e-4,o.push(milliseconds2date(l)+"-"+milliseconds2date((N+89)*i)+":"+number_format(n)+"x90x0,05% = "+number_format(Math.round(90*Number(n)*5e-4))),dg.push(dg2),o.push(milliseconds2date((N+90)*i)+"-"+milliseconds2date(_*i)+":"+number_format(n)+"x"+(_-N-90+1)+"x0,07% = "+number_format(Math.round((_-N-90+1)*Number(n)*7e-4))),dg.push(dg2),o.push(milliseconds2date((_+1)*i)+"-"+milliseconds2date(x*i)+":"+number_format(n)+"x"+(x-(_+1)+1)+"x0,05% = "+number_format(Math.round((x-(_+1)+1)*Number(n)*5e-4))),dg.push(dg3),o.push(milliseconds2date((x+1)*i)+"-"+milliseconds2date(h)+":"+number_format(n)+"x"+(y-(x+1)+1)+"x0,03% = "+number_format(Math.round((y-(x+1)+1)*Number(n)*3e-4))),dg.push(dg4))):N<=f&&(y<=f?(b=(y-N+1)*Number(n)*5e-4,o.push(milliseconds2date(l)+"-"+milliseconds2date(h)+":"+number_format(n)+"x"+(y-N+1)+"x0,05% = "+number_format(Math.round(b))),dg.push(dg1)):f+1<=y&&y<=_?f+1+90>=y?(b=(y-N+1)*Number(n)*5e-4,o.push(milliseconds2date(l)+"-"+milliseconds2date(h)+":"+number_format(n)+"x"+(y-N+1)+"x0,05% = "+number_format(Math.round(b))),dg.push(dg1+"; "+dg2)):(b=(f-N+1)*Number(n)*5e-4+90*Number(n)*5e-4+(y-(f+1)-90+1)*Number(n)*7e-4,o.push(milliseconds2date(l)+"-"+milliseconds2date(f*i)+":"+number_format(n)+"x"+(f-N+1)+"x0,05% = "+number_format(Math.round((f-N+1)*Number(n)*5e-4))),dg.push(dg1+"; "+dg2),o.push(milliseconds2date((f+1)*i)+"-"+milliseconds2date((f+90)*i)+":"+number_format(n)+"x90x0,05% = "+number_format(Math.round(90*Number(n)*5e-4))),dg.push(dg2),o.push(milliseconds2date((f+91)*i)+"-"+milliseconds2date(h)+":"+number_format(n)+"x"+(y-(f+1)-90+1)+"x0,07% = "+number_format(Math.round((y-(f+1)-90+1)*Number(n)*7e-4))),dg.push(dg2)):_+1<=y&&y<=x?(b=(f-N+1)*Number(n)*5e-4+90*Number(n)*5e-4+(_-(f+1)-90+1)*Number(n)*7e-4+(y-(_+1)+1)*Number(n)*5e-4,o.push(milliseconds2date(l)+"-"+milliseconds2date(f*i)+":"+number_format(n)+"x"+(f-N+1)+"x0,05% = "+number_format(Math.round((f-N+1)*Number(n)*5e-4))),dg.push(dg1),o.push(milliseconds2date((f+1)*i)+"-"+milliseconds2date((f+90)*i)+":"+number_format(n)+"x90x0,05% = "+number_format(90*Number(n)*5e-4)),dg.push(dg2),o.push(milliseconds2date((f+91)*i)+"-"+milliseconds2date(_*i)+":"+number_format(n)+"x"+(_-(f+1)-90+1)+"x0,07% = "+number_format(Math.round((_-(f+1)-90+1)*Number(n)*7e-4))),dg.push(dg2),o.push(milliseconds2date((_+1)*i)+"-"+milliseconds2date(h)+":"+number_format(n)+"x"+(y-(_+1)+1)+"x0,05% = "+number_format(Math.round((y-(_+1)+1)*Number(n)*5e-4))),dg.push(dg3)):y>x&&(b=(f-N+1)*Number(n)*5e-4+90*Number(n)*5e-4+(_-(f+1)-90+1)*Number(n)*7e-4+(x-(_+1)+1)*Number(n)*5e-4+(y-(x+1)+1)*Number(n)*3e-4,o.push(milliseconds2date(l)+"-"+milliseconds2date(f*i)+":"+number_format(n)+"x"+(f-N+1)+"x0,05% = "+number_format(Math.round((f-N+1)*Number(n)*5e-4))),dg.push(dg1),o.push(milliseconds2date((f+1)*i)+"-"+milliseconds2date((f+90)*i)+":"+number_format(n)+"x90x0,05% = "+number_format(Math.round(90*Number(n)*5e-4))),dg.push(dg2),o.push(milliseconds2date((f+91)*i)+"-"+milliseconds2date(_*i)+":"+number_format(n)+"x"+(_-(f+1)-90+1)+"x0,07% = "+number_format(Math.round((_-(f+1)-90+1)*Number(n)*7e-4))),dg.push(dg2),o.push(milliseconds2date((_+1)*i)+"-"+milliseconds2date(x*i)+":"+number_format(n)+"x"+(x-(_+1)+1)+"x0,05% = "+number_format(Math.round((x-(_+1)+1)*Number(n)*5e-4))),dg.push(dg3),o.push(milliseconds2date((x+1)*i)+"-"+milliseconds2date(h)+":"+number_format(n)+"x"+(y-(x+1)+1)+"x0,03% = "+number_format(Math.round((y-(x+1)+1)*Number(n)*3e-4))),dg.push(dg4)))),o.push("TỔNG TIỀN PHẠT NỘP CHẬM: "+number_format(Math.round(b))),dg.push(""),{kq:o,dg:dg}}function view_data_history(){if("undefined"!=typeof Storage)if(inner_history=document.getElementById("history"),""==inner_history.innerHTML){html='<div style="text-align:right;"><a href="javascript:void(0)" onclick="delete_all_history()">Xóa tất cả</a></div>';for(var e=localStorage.length-1;e>=0;e--){var t=localStorage.key(e);result=JSON.parse(localStorage.getItem(t)),html+=`<div id="${t}"><div class="d-flex justify-content-between font-very-small"><div><span class="ngay-tra-cuu">${milliseconds2date(result.tgian)} </span>${result.input}</div><div><a href="javascript:void(0)" onclick="delete_history('${t}')">Xóa</a></div></div>`,html+='<table class="table table-striped table-hover table-sm table-responsive-sm font-very-small"><thead><tr><th scope="col">Chi tiết</th><th scope="col">Diễn giải</th></tr></thead><tbody>';for(var n=0;n<result.kq.length;n++)html+=`<tr><td>${result.kq[n]}</td><td>${result.dg[n]}</td></tr>`;html+="</tbody></table></div>"}inner_history.innerHTML=html,document.getElementById("link-view-history").classList.remove("plus"),document.getElementById("link-view-history").classList.add("minus")}else inner_history.innerHTML="",document.getElementById("link-view-history").classList.remove("minus"),document.getElementById("link-view-history").classList.add("plus")}function delete_history(e){window.localStorage.removeItem(e),document.getElementById(e).style.display="none",0===localStorage.length&&(document.getElementById("link-history").style.display="none")}function delete_all_history(){cf=confirm("Bạn có chắn chắn muốn xóa tất cả lịch sử tra cứu của mình không?"),cf&&(window.localStorage.clear(),document.getElementById("history").innerHTML="",document.getElementById("link-history").style.display="none")}