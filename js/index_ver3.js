function uuid(){var e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.substr(t.lastIndexOf("/")+1)}function milliseconds2date(e){var t=new Date(e);return t.getDate()+"/"+(t.getMonth()+1)+"/"+t.getFullYear()}function number_format(e){if(""===(e=e.toString()).trim())return"";for(var t=e.split(""),n=t.length,r="",a=1,d=n-1;d>=0;d--){var i=a%3==0&&0!==d?".":"";r=r+t[d]+i,a++}t=r.split(""),r="";for(d=(n=t.length)-1;d>=0;d--)r+=t[d];return r}function den_ngay_law38(e,t){day_field=e.split("/")[0],month_field=e.split("/")[1],year_field=e.split("/")[2],den_ngay=new Date(year_field,Number(month_field)-1,day_field);var n=Date.parse(den_ngay),r=Math.round(n/864e5),a=new Date(2016,5,30),d=new Date(2020,5,30),i=Math.round(Date.parse(a)/864e5),s=Math.round(Date.parse(d)/864e5),h="Từ ngày 1/7/2016: Tính theo tỷ lệ 0.03% (Quy định của Luật số 106/2016/QH13)",m={cach_tinh:[],dien_giai:[]};return r<=s?(m.tong_tien=Number(t)*(r-(i+1)+1)*3e-4,m.cach_tinh.push(milliseconds2date(864e5*(i+1))+"-"+milliseconds2date(n)+":"+number_format(t)+"x"+(r-(i+1)+1)+"x0,03% = "+number_format(Math.round(Number(t)*(r-(i+1)+1)*3e-4))),m.dien_giai.push(h)):(m.tong_tien=(s-(i+1)+1+r-(s+1))*Number(t)*3e-4,m.cach_tinh.push(milliseconds2date(864e5*(i+1))+"-"+milliseconds2date(864e5*s)+":"+number_format(t)+"x"+(s-(i+1)+1)+"x0,03% = "+number_format(Math.round(Number(t)*(s-(i+1)+1)*3e-4))),m.dien_giai.push(h),m.cach_tinh.push(milliseconds2date(864e5*(s+1))+"-"+milliseconds2date(n)+":"+number_format(t)+"x"+(r-(s+1))+"x0,03% = "+number_format(Math.round(Number(t)*(r-(s+1))*3e-4))),m.dien_giai.push("Từ ngày 1/7/2020: Mức tính tiền chậm nộp và thời gian tính tiền chậm nộp được quy định theo khoản 2 Điều 59 Luật số 38/2019/QH14 ngày 13/06/2019")),m}function tinh_phat(e,t,n,r){var a,d,i,s,h,m=[];if(a=e.split("/")[0],d=e.split("/")[1],i=e.split("/")[2],(s=new Date(i,Number(d)-1,a)).getMonth()+1!=Number(d)||s.getDate()!=a||s.getFullYear()!=i)return["Bạn xác định sai ngày bắt đầu tính phạt. Ví dụ cách nhập: tính phạt chậm nộp 15.000.000 từ ngày 01/01/2016 đến 30/6/2016"];if(a=t.split("/")[0],d=t.split("/")[1],i=t.split("/")[2],(h=new Date(i,Number(d)-1,a)).getMonth()+1!=Number(d)||h.getDate()!=a||h.getFullYear()!=i)return["Bạn xác định sai ngày kết thúc tính phạt. Ví dụ cách nhập: tính phạt chậm nộp 15.000.000 từ ngày 01/01/2016 đến 30/6/2016"];var u=864e5,o=Date.parse(s),l=Date.parse(h);if(Math.round(l/u)-Math.round(o/u)+1<1)return["Số ngày tính phạt của bạn có vấn đề: ngày kết thúc tính phạt phải hơn ngày bắt đầu tính. Ví dụ cách nhập: tính phạt chậm nộp 15.000.000 từ ngày 01/01/2016 đến 30/6/2016"];var c,g=new Date(2013,5,30),_=new Date(2014,11,31),b=new Date(2016,5,30),p=new Date(2020,5,30),f=new Date(2020,11,4),y=Math.round(Date.parse(g)/u),x=Math.round(Date.parse(_)/u),N=Math.round(Date.parse(b)/u),M=Math.round(Date.parse(p)/u),v=Math.round(Date.parse(f)/u),w=Math.round(o/u),D=Math.round(l/u);if(dg1="Từ hạn nộp đến 30/6/2013: Tính theo tỷ lệ 0,05% (Quy định của Luật số 78/2006/QH11)",dg2="Từ ngày 1/7/2013 đến 31/12/2014: tỷ lệ 0,05% kể từ ngày hết thời hạn nộp thuế đến ngày thứ 90; 0,07% kể từ ngày chậm nộp thứ 91 trở đi (Quy định của Luật số 21/2012/QH13)",dg3="Từ ngày 1/1/2015 - 30/6/2016: Tính theo tỷ lệ 0,05% (Quy định của Luật số 71/2014/QH13)",dg4="Từ ngày 1/7/2016: Tính theo tỷ lệ 0.03% (Quy định của Luật số 106/2016/QH13)",dg5="Từ ngày 1/7/2020: Mức tính tiền chậm nộp và thời gian tính tiền chậm nộp được quy định theo khoản 2 Điều 59 Luật số 38/2019/QH14 ngày 13/06/2019",dg_phat_tien_phat="Theo Thông tư 166/2013/TT-BTC, tiền chậm nộp tiền phạt tính theo mức 0,05%/ngày",dg_phat_tien_phat2="Theo khoản 1, điều 42 Nghị định số 125/2020/NĐ-CP ban hành ngày ngày 19/10/2020, có hiệu lực thi hành từ ngày 05/12/2020",m=[],dg=[],0===r)w<=v?D<=v?(c=Number(n)*(D-w+1)*5e-4,dg.push(dg_phat_tien_phat),m.push(milliseconds2date(o)+"-"+milliseconds2date(l)+":"+number_format(n)+"x"+(D-w+1)+"x0,05% = "+number_format(Math.round(c)))):(c=Number(n)*(v-w+1+D-v-1)*5e-4,dg.push(dg_phat_tien_phat),m.push(milliseconds2date(o)+"-"+milliseconds2date(v*u)+":"+number_format(n)+"x"+(v-w+1)+"x0,05% = "+number_format(Math.round((v-w+1)*Number(n)*5e-4))),dg.push(dg_phat_tien_phat2),m.push(milliseconds2date((v+1)*u)+"-"+milliseconds2date(l)+":"+number_format(n)+"x"+(D-v-1)+"x0,05% = "+number_format(Math.round((D-v-1)*Number(n)*5e-4)))):(c=Number(n)*(D-w)*5e-4,dg.push(dg_phat_tien_phat2),m.push(milliseconds2date(o)+"-"+milliseconds2date(l)+":"+number_format(n)+"x"+(D-w)+"x0,05% = "+number_format(Math.round(c))));else if(1===r)if(w>N)w<=M&&M<D?(c=3e-4*(Number(n)*(M-w+1)+Number(n)*(D-(M+1))),m.push(milliseconds2date(o)+"-"+milliseconds2date(M*u)+":"+number_format(n)+"x"+(M-w+1)+"x0,03% = "+number_format(Math.round(Number(n)*(M-w+1)*3e-4))),dg.push(dg4),m.push(milliseconds2date((M+1)*u)+"-"+milliseconds2date(l)+":"+number_format(n)+"x"+(D-(M+1))+"x0,03% = "+number_format(Math.round(Number(n)*(D-(M+1))*3e-4))),dg.push(dg5)):w>M?(c=Number(n)*(D-w)*3e-4,m.push(milliseconds2date(o)+"-"+milliseconds2date(l)+":"+number_format(n)+"x"+(D-w)+"x0,03% = "+number_format(Math.round(c))),dg.push(dg5)):(c=Number(n)*(D-w+1)*3e-4,m.push(milliseconds2date(o)+"-"+milliseconds2date(l)+":"+number_format(n)+"x"+(D-w+1)+"x0,03% = "+number_format(Math.round(c))),dg.push(dg4));else if(x+1<=w&&w<=N)if(D>=N+1){c=(N-w+1)*Number(n)*5e-4,tinh_theo38=den_ngay_law38(t,n),c+=tinh_theo38.tong_tien,m.push(milliseconds2date(o)+"-"+milliseconds2date(N*u)+":"+number_format(n)+"x"+(N-w+1)+"x0,05% = "+number_format(Math.round((N-w+1)*Number(n)*5e-4))),dg.push(dg3);for(var T=0;T<tinh_theo38.cach_tinh.length;T++)m.push(tinh_theo38.cach_tinh[T]),dg.push(tinh_theo38.dien_giai[T])}else c=(D-w+1)*Number(n)*5e-4,m.push(milliseconds2date(o)+"-"+milliseconds2date(l)+":"+number_format(n)+"x"+(D-w+1)+"x0,05% = "+number_format(Math.round(c))),dg.push(dg3);else if(y+1<=w&&w<=x){if(y+1<=D&&D<=x)D-w+1<=90?(c=(D-w+1)*Number(n)*5e-4,m.push(milliseconds2date(o)+"-"+milliseconds2date(l)+":"+number_format(n)+"x"+(D-w+1)+"x0,05% = "+number_format(Math.round(c))),dg.push(dg2)):(c=90*Number(n)*5e-4+(D-w-90+1)*Number(n)*7e-4,m.push(milliseconds2date(o)+"-"+milliseconds2date((w+89)*u)+":"+number_format(n)+"x90x0,05% = "+number_format(Math.round(90*Number(n)*5e-4))),dg.push(dg2),m.push(milliseconds2date((w+90)*u)+"-"+milliseconds2date(l)+":"+number_format(n)+"x"+(D-w-90+1)+"x0,07% = "+number_format(Math.round((D-w-90+1)*Number(n)*7e-4))),dg.push(dg2));else if(x+1<=D&&D<=N)x-w+1<=90?(c=(D-w+1)*Number(n)*5e-4,m.push(milliseconds2date(o)+"-"+milliseconds2date(l)+":"+number_format(n)+"x"+(D-w+1)+"x0,05% = "+number_format(Math.round(c))),dg.push(dg2)):(c=90*Number(n)*5e-4+(x-w-90+1)*Number(n)*7e-4+(D-(x+1)+1)*Number(n)*5e-4,m.push(milliseconds2date(o)+"-"+milliseconds2date((w+89)*u)+":"+number_format(n)+"x90x0,05% = "+number_format(Math.round(90*Number(n)*5e-4))),dg.push(dg2),m.push(milliseconds2date((w+90)*u)+"-"+milliseconds2date(x*u)+":"+number_format(n)+"x"+(x-w-90+1)+"x0,07% = "+number_format(Math.round((x-w-90+1)*Number(n)*7e-4))),dg.push(dg2),m.push(milliseconds2date((x+1)*u)+"-"+milliseconds2date(l)+":"+number_format(n)+"x"+(D-(x+1)+1)+"x0,05% = "+number_format(Math.round((D-(x+1)+1)*Number(n)*5e-4))),dg.push(dg3));else if(D>N)if(x-w+1<=90){c=(N-w+1)*Number(n)*5e-4,tinh_theo38=den_ngay_law38(t,n),c+=tinh_theo38.tong_tien,m.push(milliseconds2date(o)+"-"+milliseconds2date(N*u)+":"+number_format(n)+"x"+(N-w+1)+"x0,05% = "+number_format(Math.round((N-w+1)*Number(n)*5e-4))),dg.push(dg2+"; "+dg3);for(T=0;T<tinh_theo38.cach_tinh.length;T++)m.push(tinh_theo38.cach_tinh[T]),dg.push(tinh_theo38.dien_giai[T])}else{c=90*Number(n)*5e-4+(x-w-90+1)*Number(n)*7e-4+(N-(x+1)+1)*Number(n)*5e-4,tinh_theo38=den_ngay_law38(t,n),c+=tinh_theo38.tong_tien,m.push(milliseconds2date(o)+"-"+milliseconds2date((w+89)*u)+":"+number_format(n)+"x90x0,05% = "+number_format(Math.round(90*Number(n)*5e-4))),dg.push(dg2),m.push(milliseconds2date((w+90)*u)+"-"+milliseconds2date(x*u)+":"+number_format(n)+"x"+(x-w-90+1)+"x0,07% = "+number_format(Math.round((x-w-90+1)*Number(n)*7e-4))),dg.push(dg2),m.push(milliseconds2date((x+1)*u)+"-"+milliseconds2date(N*u)+":"+number_format(n)+"x"+(N-(x+1)+1)+"x0,05% = "+number_format(Math.round((N-(x+1)+1)*Number(n)*5e-4))),dg.push(dg3);for(T=0;T<tinh_theo38.cach_tinh.length;T++)m.push(tinh_theo38.cach_tinh[T]),dg.push(tinh_theo38.dien_giai[T])}}else if(w<=y)if(D<=y)c=(D-w+1)*Number(n)*5e-4,m.push(milliseconds2date(o)+"-"+milliseconds2date(l)+":"+number_format(n)+"x"+(D-w+1)+"x0,05% = "+number_format(Math.round(c))),dg.push(dg1);else if(y+1<=D&&D<=x)y+1+90>=D?(c=(D-w+1)*Number(n)*5e-4,m.push(milliseconds2date(o)+"-"+milliseconds2date(l)+":"+number_format(n)+"x"+(D-w+1)+"x0,05% = "+number_format(Math.round(c))),dg.push(dg1+"; "+dg2)):(c=(y-w+1)*Number(n)*5e-4+90*Number(n)*5e-4+(D-(y+1)-90+1)*Number(n)*7e-4,m.push(milliseconds2date(o)+"-"+milliseconds2date(y*u)+":"+number_format(n)+"x"+(y-w+1)+"x0,05% = "+number_format(Math.round((y-w+1)*Number(n)*5e-4))),dg.push(dg1+"; "+dg2),m.push(milliseconds2date((y+1)*u)+"-"+milliseconds2date((y+90)*u)+":"+number_format(n)+"x90x0,05% = "+number_format(Math.round(90*Number(n)*5e-4))),dg.push(dg2),m.push(milliseconds2date((y+91)*u)+"-"+milliseconds2date(l)+":"+number_format(n)+"x"+(D-(y+1)-90+1)+"x0,07% = "+number_format(Math.round((D-(y+1)-90+1)*Number(n)*7e-4))),dg.push(dg2));else if(x+1<=D&&D<=N)c=(y-w+1)*Number(n)*5e-4+90*Number(n)*5e-4+(x-(y+1)-90+1)*Number(n)*7e-4+(D-(x+1)+1)*Number(n)*5e-4,m.push(milliseconds2date(o)+"-"+milliseconds2date(y*u)+":"+number_format(n)+"x"+(y-w+1)+"x0,05% = "+number_format(Math.round((y-w+1)*Number(n)*5e-4))),dg.push(dg1),m.push(milliseconds2date((y+1)*u)+"-"+milliseconds2date((y+90)*u)+":"+number_format(n)+"x90x0,05% = "+number_format(90*Number(n)*5e-4)),dg.push(dg2),m.push(milliseconds2date((y+91)*u)+"-"+milliseconds2date(x*u)+":"+number_format(n)+"x"+(x-(y+1)-90+1)+"x0,07% = "+number_format(Math.round((x-(y+1)-90+1)*Number(n)*7e-4))),dg.push(dg2),m.push(milliseconds2date((x+1)*u)+"-"+milliseconds2date(l)+":"+number_format(n)+"x"+(D-(x+1)+1)+"x0,05% = "+number_format(Math.round((D-(x+1)+1)*Number(n)*5e-4))),dg.push(dg3);else if(D>N){c=(y-w+1)*Number(n)*5e-4+90*Number(n)*5e-4+(x-(y+1)-90+1)*Number(n)*7e-4+(N-(x+1)+1)*Number(n)*5e-4,tinh_theo38=den_ngay_law38(t,n),c+=tinh_theo38.tong_tien,m.push(milliseconds2date(o)+"-"+milliseconds2date(y*u)+":"+number_format(n)+"x"+(y-w+1)+"x0,05% = "+number_format(Math.round((y-w+1)*Number(n)*5e-4))),dg.push(dg1),m.push(milliseconds2date((y+1)*u)+"-"+milliseconds2date((y+90)*u)+":"+number_format(n)+"x90x0,05% = "+number_format(Math.round(90*Number(n)*5e-4))),dg.push(dg2),m.push(milliseconds2date((y+91)*u)+"-"+milliseconds2date(x*u)+":"+number_format(n)+"x"+(x-(y+1)-90+1)+"x0,07% = "+number_format(Math.round((x-(y+1)-90+1)*Number(n)*7e-4))),dg.push(dg2),m.push(milliseconds2date((x+1)*u)+"-"+milliseconds2date(N*u)+":"+number_format(n)+"x"+(N-(x+1)+1)+"x0,05% = "+number_format(Math.round((N-(x+1)+1)*Number(n)*5e-4))),dg.push(dg3);for(T=0;T<tinh_theo38.cach_tinh.length;T++)m.push(tinh_theo38.cach_tinh[T]),dg.push(tinh_theo38.dien_giai[T])}return m.push("TỔNG TIỀN CHẬM NỘP: "+number_format(Math.round(c))),dg.push(""),{kq:m,dg:dg}}function view_data_history(){if("undefined"!=typeof Storage)if(inner_history=document.getElementById("history"),""==inner_history.innerHTML){html='<div style="text-align:right;"><a href="javascript:void(0)" onclick="delete_all_history()">Xóa tất cả</a></div>';for(var e=localStorage.length-1;e>=0;e--){var t=localStorage.key(e);result=JSON.parse(localStorage.getItem(t)),html+=`<div id="${t}"><div class="d-flex justify-content-between font-very-small"><div><span class="ngay-tra-cuu">${milliseconds2date(result.tgian)} </span>${result.input}</div><div><a href="javascript:void(0)" onclick="delete_history('${t}')">Xóa</a></div></div>`,html+='<table class="table table-striped table-hover table-sm table-responsive-sm font-very-small"><thead><tr><th scope="col">Chi tiết</th><th scope="col">Diễn giải</th></tr></thead><tbody>';for(var n=0;n<result.kq.length;n++)html+=`<tr><td>${result.kq[n]}</td><td>${result.dg[n]}</td></tr>`;html+="</tbody></table></div>"}inner_history.innerHTML=html,document.getElementById("link-view-history").classList.remove("plus"),document.getElementById("link-view-history").classList.add("minus")}else inner_history.innerHTML="",document.getElementById("link-view-history").classList.remove("minus"),document.getElementById("link-view-history").classList.add("plus")}function delete_history(e){window.localStorage.removeItem(e),document.getElementById(e).style.display="none",0===localStorage.length&&(document.getElementById("link-history").style.display="none")}function delete_all_history(){cf=confirm("Bạn có chắn chắn muốn xóa tất cả lịch sử tra cứu của mình không?"),cf&&(window.localStorage.clear(),document.getElementById("history").innerHTML="",document.getElementById("link-history").style.display="none")}